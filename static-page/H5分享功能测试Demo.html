<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>H5åˆ†äº«åŠŸèƒ½æµ‹è¯•Demo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        h1 {
            text-align: center;
            margin-bottom: 30px;
            color: #4a5568;
            font-size: 24px;
        }
        
        .section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f7fafc;
            border-radius: 12px;
            border-left: 4px solid #667eea;
        }
        
        .section h2 {
            margin-bottom: 15px;
            color: #4a5568;
            font-size: 18px;
        }
        
        .btn {
            display: block;
            width: 100%;
            padding: 15px 20px;
            margin: 10px 0;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }
        
        .btn:hover {
            background: #5a6fd8;
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background: #e2e8f0;
            color: #4a5568;
        }
        
        .btn-secondary:hover {
            background: #cbd5e0;
        }
        
        .status {
            margin-top: 10px;
            padding: 10px;
            border-radius: 8px;
            font-size: 14px;
            display: none;
        }
        
        .status.success {
            background: #c6f6d5;
            color: #22543d;
            display: block;
        }
        
        .status.error {
            background: #fed7d7;
            color: #742a2a;
            display: block;
        }
        
        .status.info {
            background: #bee3f8;
            color: #1a365d;
            display: block;
        }
        
        .file-input {
            margin: 15px 0;
        }
        
        .custom-share-panel {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: none;
            align-items: flex-end;
            z-index: 1000;
        }
        
        .share-content {
            background: white;
            width: 100%;
            padding: 30px 20px;
            border-radius: 20px 20px 0 0;
            transform: translateY(100%);
            transition: transform 0.3s ease;
        }
        
        .share-content.show {
            transform: translateY(0);
        }
        
        .share-platforms {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        
        .platform-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 15px 10px;
            background: #f7fafc;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .platform-btn:hover {
            background: #e2e8f0;
            transform: scale(1.05);
        }
        
        .platform-icon {
            font-size: 24px;
            margin-bottom: 5px;
        }
        
        .close-btn {
            display: block;
            width: 100%;
            padding: 15px;
            background: #e53e3e;
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            cursor: pointer;
            margin-top: 20px;
        }
        
        .compatibility {
            background: #fffaf0;
            border-left-color: #dd6b20;
            margin-top: 20px;
        }
        
        .compatibility-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #fed7aa;
        }
        
        .compatibility-item:last-child {
            border-bottom: none;
        }
        
        .support {
            color: #38a169;
            font-weight: bold;
        }
        
        .unsupport {
            color: #e53e3e;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“± H5åˆ†äº«åŠŸèƒ½æµ‹è¯•Demo</h1>
        
        <!-- æ–¹æ³•ä¸€ï¼šWeb Share API -->
        <div class="section">
            <h2>æ–¹æ³•ä¸€ï¼šWeb Share APIï¼ˆæ¨èï¼‰</h2>
            <button class="btn" id="webShareBtn">ğŸ“¤ ä½¿ç”¨Web Share APIåˆ†äº«</button>
            <button class="btn btn-secondary" id="webShareFileBtn">ğŸ“ åˆ†äº«æ–‡ä»¶ï¼ˆé€‰æ‹©å›¾ç‰‡ï¼‰</button>
            <input type="file" id="fileInput" class="file-input" accept="image/*" style="display: none;">
            <div id="webShareStatus" class="status"></div>
        </div>
        
        <!-- æ–¹æ³•äºŒï¼šè‡ªå®šä¹‰åˆ†äº«é¢æ¿ -->
        <div class="section">
            <h2>æ–¹æ³•äºŒï¼šè‡ªå®šä¹‰åˆ†äº«é¢æ¿</h2>
            <button class="btn" id="customShareBtn">ğŸ¨ æ‰“å¼€è‡ªå®šä¹‰åˆ†äº«é¢æ¿</button>
            <div id="customShareStatus" class="status"></div>
        </div>
        
        <!-- æ–¹æ³•ä¸‰ï¼šå¹³å°ç‰¹å®šåˆ†äº« -->
        <div class="section">
            <h2>æ–¹æ³•ä¸‰ï¼šå¹³å°ç‰¹å®šåˆ†äº«</h2>
            <button class="btn" id="wechatShareBtn">ğŸ’¬ æ¨¡æ‹Ÿå¾®ä¿¡åˆ†äº«</button>
            <button class="btn" id="qqShareBtn">ğŸ§ æ¨¡æ‹ŸQQåˆ†äº«</button>
            <button class="btn" id="weiboShareBtn">ğŸŒŸ åˆ†äº«åˆ°å¾®åš</button>
            <div id="platformShareStatus" class="status"></div>
        </div>
        
        <!-- æ–¹æ³•å››ï¼šå¤åˆ¶é“¾æ¥ -->
        <div class="section">
            <h2>æ–¹æ³•å››ï¼šå¤åˆ¶é“¾æ¥</h2>
            <button class="btn" id="copyLinkBtn">ğŸ“‹ å¤åˆ¶é¡µé¢é“¾æ¥</button>
            <div id="copyStatus" class="status"></div>
        </div>
        
        <!-- æµè§ˆå™¨å…¼å®¹æ€§ä¿¡æ¯ -->
        <div class="section compatibility">
            <h2>ğŸ“Š æµè§ˆå™¨å…¼å®¹æ€§æ£€æµ‹</h2>
            <div id="compatibilityInfo"></div>
        </div>
    </div>
    
    <!-- è‡ªå®šä¹‰åˆ†äº«é¢æ¿ -->
    <div class="custom-share-panel" id="customSharePanel">
        <div class="share-content" id="shareContent">
            <h3 style="text-align: center; margin-bottom: 20px;">åˆ†äº«åˆ°</h3>
            <div class="share-platforms">
                <button class="platform-btn" onclick="shareToPlatform('wechat')">
                    <span class="platform-icon">ğŸ’¬</span>
                    <span>å¾®ä¿¡</span>
                </button>
                <button class="platform-btn" onclick="shareToPlatform('qq')">
                    <span class="platform-icon">ğŸ§</span>
                    <span>QQ</span>
                </button>
                <button class="platform-btn" onclick="shareToPlatform('weibo')">
                    <span class="platform-icon">ğŸŒŸ</span>
                    <span>å¾®åš</span>
                </button>
                <button class="platform-btn" onclick="shareToPlatform('qzone')">
                    <span class="platform-icon">ğŸ“Œ</span>
                    <span>QQç©ºé—´</span>
                </button>
                <button class="platform-btn" onclick="shareToPlatform('douyin')">
                    <span class="platform-icon">ğŸµ</span>
                    <span>æŠ–éŸ³</span>
                </button>
                <button class="platform-btn" onclick="copyLink()">
                    <span class="platform-icon">ğŸ“‹</span>
                    <span>å¤åˆ¶é“¾æ¥</span>
                </button>
                <button class="platform-btn" onclick="shareToPlatform('more')">
                    <span class="platform-icon">â‹¯</span>
                    <span>æ›´å¤š</span>
                </button>
                <button class="platform-btn" onclick="shareToPlatform('system')">
                    <span class="platform-icon">ğŸ“¤</span>
                    <span>ç³»ç»Ÿåˆ†äº«</span>
                </button>
            </div>
            <button class="close-btn" onclick="closeCustomSharePanel()">å…³é—­</button>
        </div>
    </div>

    <script>
        // åˆ†äº«å·¥å…·ç±»
        class ShareUtils {
            constructor() {
                this.isWechat = /MicroMessenger/i.test(navigator.userAgent);
                this.isQQ = /QQ/i.test(navigator.userAgent);
                this.isWeibo = /Weibo/i.test(navigator.userAgent);
            }
            
            // æ–¹æ³•1: Web Share API
            async webShare(options = {}) {
                const {
                    title = 'H5åˆ†äº«åŠŸèƒ½æµ‹è¯•Demo',
                    text = 'è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•H5åˆ†äº«åŠŸèƒ½çš„é¡µé¢ï¼Œå¿«æ¥ä½“éªŒå§ï¼',
                    url = window.location.href,
                    files = []
                } = options;
                
                if (navigator.share) {
                    try {
                        let shareData = { title, text };
                        
                        if (files.length > 0) {
                            if (navigator.canShare && navigator.canShare({ files })) {
                                shareData.files = files;
                            }
                        } else {
                            shareData.url = url;
                        }
                        
                        await navigator.share(shareData);
                        this.showStatus('webShareStatus', 'âœ… Web Share APIåˆ†äº«æˆåŠŸï¼', 'success');
                        return true;
                    } catch (error) {
                        if (error.name !== 'AbortError') {
                            this.showStatus('webShareStatus', 'âŒ åˆ†äº«å–æ¶ˆæˆ–å¤±è´¥: ' + error.message, 'error');
                        }
                        return false;
                    }
                } else {
                    this.showStatus('webShareStatus', 'âŒ æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒWeb Share API', 'error');
                    return false;
                }
            }
            
            // æ–¹æ³•2: è‡ªå®šä¹‰åˆ†äº«
            customShare() {
                const panel = document.getElementById('customSharePanel');
                const content = document.getElementById('shareContent');
                panel.style.display = 'flex';
                setTimeout(() => content.classList.add('show'), 10);
            }
            
            // æ–¹æ³•3: å¹³å°ç‰¹å®šåˆ†äº«
            platformShare(platform) {
                const title = 'H5åˆ†äº«åŠŸèƒ½æµ‹è¯•Demo';
                const text = 'è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•H5åˆ†äº«åŠŸèƒ½çš„é¡µé¢';
                const url = window.location.href;
                
                switch(platform) {
                    case 'wechat':
                        this.showStatus('platformShareStatus', 'ğŸ’¬ å¾®ä¿¡åˆ†äº«ï¼šéœ€è¦æ¥å…¥å¾®ä¿¡JS-SDKï¼Œå½“å‰ä¸ºæ¨¡æ‹Ÿæ¼”ç¤º', 'info');
                        break;
                    case 'qq':
                        if (this.isQQ) {
                            const qqUrl = `mqqapi://share/to_fri?file_type=news&title=${encodeURIComponent(title)}&url=${encodeURIComponent(url)}`;
                            window.location.href = qqUrl;
                        } else {
                            this.showStatus('platformShareStatus', 'ğŸ§ QQåˆ†äº«ï¼šæ¨¡æ‹ŸQQæµè§ˆå™¨åˆ†äº«ï¼ˆè¯·åœ¨QQä¸­æ‰“å¼€ï¼‰', 'info');
                        }
                        break;
                    case 'weibo':
                        const weiboUrl = `http://service.weibo.com/share/share.php?title=${encodeURIComponent(title + ' - ' + text)}&url=${encodeURIComponent(url)}`;
                        window.open(weiboUrl, '_blank', 'width=600,height=400');
                        this.showStatus('platformShareStatus', 'ğŸŒŸ å·²æ‰“å¼€å¾®åšåˆ†äº«é¡µé¢', 'success');
                        break;
                }
            }
            
            // æ–¹æ³•4: å¤åˆ¶é“¾æ¥
            async copyToClipboard() {
                const text = window.location.href + ' - H5åˆ†äº«åŠŸèƒ½æµ‹è¯•Demo';
                
                try {
                    if (navigator.clipboard) {
                        await navigator.clipboard.writeText(text);
                        this.showStatus('copyStatus', 'âœ… é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿: ' + text, 'success');
                    } else {
                        // å…¼å®¹æ—§æµè§ˆå™¨
                        const textArea = document.createElement('textarea');
                        textArea.value = text;
                        document.body.appendChild(textArea);
                        textArea.select();
                        const successful = document.execCommand('copy');
                        document.body.removeChild(textArea);
                        
                        if (successful) {
                            this.showStatus('copyStatus', 'âœ… é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿', 'success');
                        } else {
                            throw new Error('å¤åˆ¶å¤±è´¥');
                        }
                    }
                } catch (err) {
                    this.showStatus('copyStatus', 'âŒ å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶: ' + text, 'error');
                }
            }
            
            // æ˜¾ç¤ºçŠ¶æ€ä¿¡æ¯
            showStatus(elementId, message, type) {
                const element = document.getElementById(elementId);
                element.textContent = message;
                element.className = `status ${type}`;
                
                // 3ç§’åè‡ªåŠ¨éšè—
                setTimeout(() => {
                    element.style.display = 'none';
                }, 3000);
            }
            
            // æ£€æµ‹å…¼å®¹æ€§
            checkCompatibility() {
                const info = document.getElementById('compatibilityInfo');
                const compatibilities = [
                    { name: 'Web Share API', supported: !!navigator.share },
                    { name: 'Clipboard API', supported: !!navigator.clipboard },
                    { name: 'æ–‡ä»¶åˆ†äº«', supported: !!(navigator.share && navigator.canShare) },
                    { name: 'å¾®ä¿¡ç¯å¢ƒ', supported: this.isWechat },
                    { name: 'QQç¯å¢ƒ', supported: this.isQQ },
                    { name: 'å¾®åšç¯å¢ƒ', supported: this.isWeibo }
                ];
                
                let html = '';
                compatibilities.forEach(item => {
                    html += `
                        <div class="compatibility-item">
                            <span>${item.name}</span>
                            <span class="${item.supported ? 'support' : 'unsupport'}">
                                ${item.supported ? 'âœ… æ”¯æŒ' : 'âŒ ä¸æ”¯æŒ'}
                            </span>
                        </div>
                    `;
                });
                
                info.innerHTML = html;
            }
        }

        // åˆå§‹åŒ–
        const shareUtils = new ShareUtils();
        
        // é¡µé¢åŠ è½½å®Œæˆåæ£€æµ‹å…¼å®¹æ€§
        document.addEventListener('DOMContentLoaded', function() {
            shareUtils.checkCompatibility();
            
            // ç»‘å®šäº‹ä»¶
            document.getElementById('webShareBtn').addEventListener('click', () => {
                shareUtils.webShare();
            });
            
            document.getElementById('webShareFileBtn').addEventListener('click', () => {
                document.getElementById('fileInput').click();
            });
            
            document.getElementById('fileInput').addEventListener('change', (event) => {
                const file = event.target.files[0];
                if (file) {
                    shareUtils.webShare({ files: [file] });
                }
            });
            
            document.getElementById('customShareBtn').addEventListener('click', () => {
                shareUtils.customShare();
            });
            
            document.getElementById('wechatShareBtn').addEventListener('click', () => {
                shareUtils.platformShare('wechat');
            });
            
            document.getElementById('qqShareBtn').addEventListener('click', () => {
                shareUtils.platformShare('qq');
            });
            
            document.getElementById('weiboShareBtn').addEventListener('click', () => {
                shareUtils.platformShare('weibo');
            });
            
            document.getElementById('copyLinkBtn').addEventListener('click', () => {
                shareUtils.copyToClipboard();
            });
        });

        // è‡ªå®šä¹‰åˆ†äº«é¢æ¿åŠŸèƒ½
        function shareToPlatform(platform) {
            switch(platform) {
                case 'wechat':
                    shareUtils.showStatus('customShareStatus', 'ğŸ’¬ åˆ†äº«åˆ°å¾®ä¿¡ï¼ˆæ¨¡æ‹Ÿï¼‰', 'info');
                    break;
                case 'qq':
                    shareUtils.showStatus('customShareStatus', 'ğŸ§ åˆ†äº«åˆ°QQï¼ˆæ¨¡æ‹Ÿï¼‰', 'info');
                    break;
                case 'weibo':
                    shareUtils.platformShare('weibo');
                    break;
                case 'qzone':
                    shareUtils.showStatus('customShareStatus', 'ğŸ“Œ åˆ†äº«åˆ°QQç©ºé—´ï¼ˆæ¨¡æ‹Ÿï¼‰', 'info');
                    break;
                case 'douyin':
                    shareUtils.showStatus('customShareStatus', 'ğŸµ åˆ†äº«åˆ°æŠ–éŸ³ï¼ˆæ¨¡æ‹Ÿï¼‰', 'info');
                    break;
                case 'more':
                    shareUtils.webShare();
                    break;
                case 'system':
                    shareUtils.webShare();
                    break;
            }
            closeCustomSharePanel();
        }
        
        function copyLink() {
            shareUtils.copyToClipboard();
            closeCustomSharePanel();
        }
        
        function closeCustomSharePanel() {
            const panel = document.getElementById('customSharePanel');
            const content = document.getElementById('shareContent');
            content.classList.remove('show');
            setTimeout(() => {
                panel.style.display = 'none';
            }, 300);
        }

        // ç‚¹å‡»é¢æ¿å¤–éƒ¨å…³é—­
        document.getElementById('customSharePanel').addEventListener('click', function(e) {
            if (e.target === this) {
                closeCustomSharePanel();
            }
        });
    </script>
</body>
</html>