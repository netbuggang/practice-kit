<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>åœºæ™¯3ï¼šåŠ¨ç”»è§¦å‘ | IntersectionObserver</title>
  <link rel="stylesheet" href="../css/style.css">
  <style>
    .animate-box {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 2.5rem;
      border-radius: 16px;
      margin: 3rem 0;
      text-align: center;
      transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
      opacity: 0;
      transform: translateY(50px) scale(0.95);
    }

    .animate-box.visible {
      opacity: 1;
      transform: translateY(0) scale(1);
    }

    .animate-box:nth-child(even) {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      transform: translateX(-50px);
    }

    .animate-box:nth-child(even).visible {
      transform: translateX(0);
    }

    .progress-container {
      position: sticky;
      top: 10px;
      z-index: 100;
      background: white;
      padding: 1rem;
      border-radius: 8px;
      margin-bottom: 2rem;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      text-align: center;
    }

    .count-badge {
      background: #667eea;
      color: white;
      padding: 0.3rem 0.8rem;
      border-radius: 20px;
      font-size: 0.9rem;
      margin-left: 0.5rem;
    }

    .trigger-info {
      background: #f1f5f9;
      padding: 1rem;
      border-radius: 8px;
      margin-top: 2rem;
    }

    .dot {
      display: inline-block;
      width: 10px;
      height: 10px;
      background: #94a3b8;
      border-radius: 50%;
      margin-right: 5px;
      transition: background 0.3s;
    }

    .dot.active {
      background: #667eea;
      box-shadow: 0 0 10px #667eea;
    }
  </style>
</head>

<body>
  <div class="page-header">
    <a href="../index.html" class="back-link">â† è¿”å›ä¸»é¡µ</a>
    <h1>ğŸ¬ åœºæ™¯3ï¼šåŠ¨ç”»è§¦å‘</h1>
    <div style="width: 80px;"></div>
  </div>

  <div class="demo-container">
    <div class="explain">
      <strong>ğŸ’¡ åŸç†ï¼š</strong> å…ƒç´ é»˜è®¤é€æ˜ä¸”åç§»ï¼Œå½“è¿›å…¥è§†å£æ—¶æ·»åŠ  .visible ç±»ï¼Œ
      è§¦å‘ CSS è¿‡æ¸¡åŠ¨ç”»ã€‚ç¦»å¼€è§†å£æ—¶è‡ªåŠ¨ç§»é™¤ç±»ï¼Œå…ƒç´ æ¢å¤åŸçŠ¶ã€‚
    </div>

    <div class="progress-container">
      <span id="triggerCount">å·²è§¦å‘åŠ¨ç”»: 0 / 8</span>
      <span class="count-badge">å‘ä¸‹æ»šåŠ¨ä½“éªŒæ•ˆæœ</span>
    </div>

    <div class="trigger-info">
      <div style="display: flex; gap: 0.5rem; align-items: center; flex-wrap: wrap;">
        <span class="dot" id="dot1"></span> å…ƒç´ 1
        <span class="dot" id="dot2"></span> å…ƒç´ 2
        <span class="dot" id="dot3"></span> å…ƒç´ 3
        <span class="dot" id="dot4"></span> å…ƒç´ 4
        <span class="dot" id="dot5"></span> å…ƒç´ 5
        <span class="dot" id="dot6"></span> å…ƒç´ 6
        <span class="dot" id="dot7"></span> å…ƒç´ 7
        <span class="dot" id="dot8"></span> å…ƒç´ 8
      </div>
    </div>

    <!-- ç¬¬ä¸€ä¸ªåŠ¨ç”»å…ƒç´  -->
    <div class="animate-box" id="box1">
      <h2>âœ¨ å…ƒç´  1ï¼šæ·¡å…¥ä¸Šæµ®æ•ˆæœ</h2>
      <p>opacity: 0 â†’ 1, transform: translateY(50px) â†’ 0</p>
    </div>

    <div
      style="height: 300px; background: #f1f5f9; display: flex; align-items: center; justify-content: center; border-radius: 12px; margin: 2rem 0;">
      â¬‡ï¸ æ»šåŠ¨ç»§ç»­ä½“éªŒå…¶ä»–åŠ¨ç”»å…ƒç´ 
    </div>

    <!-- ç¬¬äºŒä¸ªåŠ¨ç”»å…ƒç´  -->
    <div class="animate-box" id="box2">
      <h2>ğŸ‰ å…ƒç´  2ï¼šå·¦æ»‘è¿›å…¥</h2>
      <p>transform: translateX(-50px) â†’ 0</p>
    </div>

    <div
      style="height: 300px; background: #f1f5f9; display: flex; align-items: center; justify-content: center; border-radius: 12px; margin: 2rem 0;">
      â¬‡ï¸ ç»§ç»­å‘ä¸‹
    </div>

    <!-- åç»­åŠ¨ç”»å…ƒç´  -->
    <div class="animate-box" id="box3">
      <h2>ğŸŒŸ å…ƒç´  3ï¼šç¼©æ”¾è¿›å…¥</h2>
      <p>transform: scale(0.8) â†’ 1</p>
    </div>

    <div class="animate-box" id="box4">
      <h2>ğŸŒˆ å…ƒç´  4ï¼šæ—‹è½¬è¿›å…¥</h2>
      <p>transform: rotate(-10deg) â†’ 0</p>
    </div>

    <div class="animate-box" id="box5">
      <h2>âš¡ å…ƒç´  5ï¼šå¼¹æ€§æ•ˆæœ</h2>
      <p>transition-timing-function: cubic-bezier(0.68, -0.55, 0.265, 1.55)</p>
    </div>

    <div class="animate-box" id="box6">
      <h2>ğŸ¯ å…ƒç´  6ï¼šæ·¡å…¥æ·¡å‡º</h2>
      <p>æ¯æ¬¡å‡ºç°éƒ½é‡æ–°è§¦å‘</p>
    </div>

    <div class="animate-box" id="box7">
      <h2>ğŸ’« å…ƒç´  7ï¼šç»„åˆåŠ¨ç”»</h2>
      <p>opacity + translate + scale</p>
    </div>

    <div class="animate-box" id="box8">
      <h2>ğŸª å…ƒç´  8ï¼šæœ€åä¸€ä¸ª</h2>
      <p>çœ‹çœ‹å…¨éƒ¨è§¦å‘åçš„æ•ˆæœ</p>
    </div>
  </div>

  <script>
    const boxes = [
      'box1', 'box2', 'box3', 'box4',
      'box5', 'box6', 'box7', 'box8'
    ].map(id => document.getElementById(id));

    const dots = [
      'dot1', 'dot2', 'dot3', 'dot4',
      'dot5', 'dot6', 'dot7', 'dot8'
    ].map(id => document.getElementById(id));

    // IntersectionObserver é…ç½®
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        const index = boxes.indexOf(entry.target);
        if (index !== -1) {
          if (entry.isIntersecting) {
            entry.target.classList.add('visible');
            dots[index]?.classList.add('active');
          } else {
            entry.target.classList.remove('visible');
            dots[index]?.classList.remove('active');
          }
        }
      });

      // æ›´æ–°è®¡æ•°
      const visibleCount = document.querySelectorAll('.animate-box.visible').length;
      document.getElementById('triggerCount').innerHTML =
        `å·²è§¦å‘åŠ¨ç”»: ${visibleCount} / ${boxes.length}`;
    }, {
      threshold: 0.3, // 30% è¿›å…¥è§†å£æ—¶è§¦å‘
      rootMargin: '0px'
    });

    // è§‚å¯Ÿæ‰€æœ‰åŠ¨ç”»å…ƒç´ 
    boxes.forEach(box => {
      if (box) observer.observe(box);
    });

    // ä¸ºç¬¬ä¸‰ä¸ªå…ƒç´ è®¾ç½®ä¸åŒçš„é˜ˆå€¼
    if (boxes[2]) {
      observer.unobserve(boxes[2]);
      const specialObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('visible');
            dots[2]?.classList.add('active');
          } else {
            entry.target.classList.remove('visible');
            dots[2]?.classList.remove('active');
          }
        });
      }, { threshold: 0.5 });
      specialObserver.observe(boxes[2]);
    }
  </script>
</body>

</html>
